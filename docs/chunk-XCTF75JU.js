import{B as d,Ec as f,Md as u,W as l,a as p,g as r,la as c,na as h,oa as g,w as m}from"./chunk-NP44RD24.js";var C=0,v=class{constructor(t,o,e){this.nzSingletonService=t,this.overlay=o,this.injector=e}remove(t){this.container&&(t?this.container.remove(t):this.container.removeAll())}getInstanceId(){return`${this.componentPrefix}-${C++}`}withContainer(t){let o=this.nzSingletonService.getSingletonWithKey(this.componentPrefix);if(o)return o;let e=this.overlay.create({hasBackdrop:!1,scrollStrategy:this.overlay.scrollStrategies.noop(),positionStrategy:this.overlay.position().global()}),n=new u(t,null,this.injector),i=e.attach(n),a=e.hostElement;return a.style.zIndex="1010",o||(this.container=o=i.instance,this.nzSingletonService.registerSingletonWithKey(this.componentPrefix,o),this.container.afterAllInstancesRemoved.subscribe(()=>{this.container=void 0,this.nzSingletonService.unregisterSingletonWithKey(this.componentPrefix),e.dispose()})),o}},oe=(()=>{let t=class t{constructor(e,n){this.cdr=e,this.nzConfigService=n,this.instances=[],this._afterAllInstancesRemoved=new r,this.afterAllInstancesRemoved=this._afterAllInstancesRemoved.asObservable(),this.destroy$=new r,this.updateConfig()}ngOnInit(){this.subscribeConfigChange()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}create(e){let n=this.onCreate(e);return this.instances.length>=this.config.nzMaxStack&&(this.instances=this.instances.slice(1)),this.instances=[...this.instances,n],this.readyInstances(),n}remove(e,n=!1){this.instances.map((i,a)=>({index:a,instance:i})).filter(({instance:i})=>i.messageId===e).forEach(({index:i,instance:a})=>{this.instances.splice(i,1),this.instances=[...this.instances],this.onRemove(a,n),this.readyInstances()}),this.instances.length||this.onAllInstancesRemoved()}removeAll(){this.instances.forEach(e=>this.onRemove(e,!1)),this.instances=[],this.readyInstances(),this.onAllInstancesRemoved()}onCreate(e){return e.options=this.mergeOptions(e.options),e.onClose=new r,e}onRemove(e,n){e.onClose.next(n),e.onClose.complete()}onAllInstancesRemoved(){this._afterAllInstancesRemoved.next(),this._afterAllInstancesRemoved.complete()}readyInstances(){this.cdr.detectChanges()}mergeOptions(e){let{nzDuration:n,nzAnimate:i,nzPauseOnHover:a}=this.config;return p({nzDuration:n,nzAnimate:i,nzPauseOnHover:a},e)}};t.\u0275fac=function(n){return new(n||t)(c(h),c(f))},t.\u0275dir=l({type:t});let s=t;return s})(),ae=(()=>{let t=class t{constructor(e){this.cdr=e,this.destroyed=new g,this.animationStateChanged=new r,this.userAction=!1,this.eraseTimer=null}ngOnInit(){this.options=this.instance.options,this.options.nzAnimate&&(this.instance.state="enter",this.animationStateChanged.pipe(m(e=>e.phaseName==="done"&&e.toState==="leave"),d(1)).subscribe(()=>{clearTimeout(this.closeTimer),this.destroyed.next({id:this.instance.messageId,userAction:this.userAction})})),this.autoClose=this.options.nzDuration>0,this.autoClose&&(this.initErase(),this.startEraseTimeout())}ngOnDestroy(){this.autoClose&&this.clearEraseTimeout(),this.animationStateChanged.complete()}onEnter(){this.autoClose&&this.options.nzPauseOnHover&&(this.clearEraseTimeout(),this.updateTTL())}onLeave(){this.autoClose&&this.options.nzPauseOnHover&&this.startEraseTimeout()}destroy(e=!1){this.userAction=e,this.options.nzAnimate?(this.instance.state="leave",this.cdr.detectChanges(),this.closeTimer=setTimeout(()=>{this.closeTimer=void 0,this.destroyed.next({id:this.instance.messageId,userAction:e})},200)):this.destroyed.next({id:this.instance.messageId,userAction:e})}initErase(){this.eraseTTL=this.options.nzDuration,this.eraseTimingStart=Date.now()}updateTTL(){this.autoClose&&(this.eraseTTL-=Date.now()-this.eraseTimingStart)}startEraseTimeout(){this.eraseTTL>0?(this.clearEraseTimeout(),this.eraseTimer=setTimeout(()=>this.destroy(),this.eraseTTL),this.eraseTimingStart=Date.now()):this.destroy()}clearEraseTimeout(){this.eraseTimer!==null&&(clearTimeout(this.eraseTimer),this.eraseTimer=null)}};t.\u0275fac=function(n){return new(n||t)(c(h))},t.\u0275dir=l({type:t});let s=t;return s})();export{v as a,oe as b,ae as c};
