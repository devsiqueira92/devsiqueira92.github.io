<form nz-form [formGroup]="formGroup" nz-row [nzGutter]="16">
  <div class="gutter-row mb-3" nz-col [nzSpan]="24">
    <h2>Agendamentos</h2>
    <div nz-row [nzGutter]="16">
      <div nz-col [nzXs]="{ span: 24 }" [nzLg]="{ span: 16 }">
        <app-input
          *ngIf="mode === 'edit'"
          [placeholder]="'Id'"
          controlName="id"
          [parentForm]="formGroup"
          type="text"
        ></app-input>

        <div nz-row [nzGutter]="16">
          <div
            *ngIf="patientList$ | async as patients"
            nz-col
            [nzXs]="{ span: 24 }"
            [nzLg]="{ span: 12 }"
          >
            <app-select
              controlName="patient"
              [parentForm]="formGroup"
              [placeholder]="'Paciente'"
              [hasFloatingLabel]="false"
              [options]="patients"
            ></app-select>
          </div>

          <div
            *ngIf="physioterapistList$ | async as physioterapist"
            nz-col
            [nzXs]="{ span: 24 }"
            [nzLg]="{ span: 12 }"
          >
            <app-select
              controlName="doctor"
              [parentForm]="formGroup"
              [placeholder]="'Profissional do atendimento'"
              [hasFloatingLabel]="false"
              [options]="physioterapist"
            ></app-select>
          </div>
        </div>

        <div nz-row [nzGutter]="16">
          <app-datepicker
            [placeholder]="'Data'"
            controlName="date"
            [parentForm]="formGroup"
            nz-col
            [nzSpan]="12"
          ></app-datepicker>

          <app-time-picker
            [placeholder]="'Hora'"
            controlName="time"
            [parentForm]="formGroup"
            nz-col
            [nzSpan]="12"
          ></app-time-picker>
        </div>
      </div>
      <div
        nz-col
        [nzXs]="{ span: 24 }"
        [nzLg]="{ span: 8 }"
        *ngIf="mode !== 'view'"
        class="edit-appointment"
      >
        <app-back-submit-panel
          (back)="back()"
          (submit)="editAppointment()"
          [disabled]="
            !formGroup.valid || formGroup.controls.isSubmitting?.value === true
          "
        ></app-back-submit-panel>
      </div>
    </div>
  </div>

  <div class="gutter-row" nz-col [nzSpan]="24" *ngIf="mode === 'view'">
    <h2>Detalhes da consulta</h2>
    <div class="scheduling-details-form" nz-row [nzGutter]="16">
      <app-input
        [placeholder]="'Oxigenacão sanguinea'"
        controlName="bloodOxygenation"
        [parentForm]="formGroup"
        type="text"
        nz-col
        [nzXs]="{ span: 24 }"
        [nzLg]="{ span: 8 }"
      ></app-input>

      <app-input
        [placeholder]="'Batimentos p/ minuto'"
        controlName="bpm"
        [parentForm]="formGroup"
        type="text"
        nz-col
        [nzXs]="{ span: 24 }"
        [nzLg]="{ span: 8 }"
      ></app-input>

      <app-input
        [placeholder]="'Sinais vitais'"
        controlName="vitals"
        [parentForm]="formGroup"
        type="text"
        nz-col
        [nzXs]="{ span: 24 }"
        [nzLg]="{ span: 8 }"
      ></app-input>

      <app-text-area
        [placeholder]="'Evolução'"
        controlName="notes"
        [parentForm]="formGroup"
        nz-col
        [nzXs]="{ span: 24 }"
        [nzLg]="{ span: 20 }"
      ></app-text-area>

      <div
        id="protocols-button"
        nz-col
        [nzXs]="{ span: 24 }"
        [nzLg]="{ span: 4 }"
      >
        <app-button
          label="Protocolos"
          icon="left"
          (click)="open()"
        ></app-button>
      </div>
    </div>

    <app-back-submit-panel
      (back)="back()"
      (submit)="endAppointment()"
      [disabled]="
        !formGroup.valid || formGroup.controls.isSubmitting?.value === true
      "
    ></app-back-submit-panel>
  </div>
</form>
<!--
<nz-drawer
  [nzClosable]="false"
  [nzVisible]="visible"
  nzPlacement="right"
  nzTitle="Lista de protocolos"
  (nzOnClose)="close()"
  [nzFooter]="footerTpl"
  [nzMaskClosable]="false"
  [nzBodyStyle]="{ overflow: 'auto' }"
>
  <ng-container *nzDrawerContent>
    <ul>
      <li
        *ngFor="let item of procedureList$ | async"
        (click)="selectProtocol(item)"
      >
        <span nz-icon nzType="caret-left" nzTheme="outline"></span>
        {{ item.name }}
      </li>
    </ul>
  </ng-container>

  <ng-template #footerTpl>
    <div style="float: right">
      <button nz-button style="margin-right: 8px" (click)="close()">
        Cancel
      </button>
      <button nz-button nzType="primary" (click)="close()">Submit</button>
    </div>
  </ng-template>
</nz-drawer> -->

<nz-drawer
  [nzVisible]="visible"
  nzPlacement="right"
  nzTitle="Lista de protocolos"
  [nzFooter]="footerTpl"
  (nzOnClose)="close()"
  [nzWidth]="getWidthScreen()"
>
  <ng-container *nzDrawerContent>
    <ul>
      <li
        *ngFor="let item of procedureList$ | async"
        (click)="selectProtocol(item)"
      >
        <span nz-icon nzType="caret-left" nzTheme="outline"></span>
        {{ item.name }}
      </li>
    </ul>
  </ng-container>
</nz-drawer>
<ng-template #footerTpl>
  <button nz-button nzType="default" (click)="close()">Fechar</button>
</ng-template>
